<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to PDF Pro | Secure Converter</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Mammoth.js (Reads .docx files) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    
    <!-- Html2Pdf.js (Generates PDF) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Document Preview Styling (Mimics A4 Paper) */
        #doc-preview {
            font-family: 'Calibri', 'Arial', sans-serif;
            line-height: 1.6;
            color: #000;
        }
        #doc-preview p { margin-bottom: 1em; }
        #doc-preview h1 { font-size: 24pt; font-weight: bold; margin-bottom: 0.5em; }
        #doc-preview h2 { font-size: 18pt; font-weight: bold; margin-top: 1em; margin-bottom: 0.5em; }
        #doc-preview table { border-collapse: collapse; width: 100%; margin-bottom: 1em; }
        #doc-preview td, #doc-preview th { border: 1px solid #ddd; padding: 8px; }
        #doc-preview img { max-width: 100%; height: auto; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <div class="bg-blue-700 text-white w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                        <i class="fa-solid fa-file-word"></i>
                    </div>
                    <span class="font-bold text-xl tracking-tight text-slate-900">Word<span class="text-blue-700">2PDF</span></span>
                </div>
                <div class="text-xs font-medium text-slate-500 bg-slate-100 px-3 py-1 rounded-full">
                    v2.0 Client-Side
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow flex flex-col items-center justify-center p-6">
        
        <div class="w-full max-w-2xl bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden fade-in">
            
            <!-- Header -->
            <div class="bg-slate-900 p-8 text-center text-white">
                <h1 class="text-2xl font-bold mb-2">Convert Word to PDF</h1>
                <p class="text-slate-400 text-sm">Transform .docx files into professional PDFs instantly.</p>
            </div>

            <div class="p-8 space-y-6">
                
                <!-- Upload Area -->
                <div id="drop-zone" class="relative group w-full h-48 border-2 border-dashed border-slate-300 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all bg-slate-50" onclick="document.getElementById('file-input').click()">
                    <input type="file" id="file-input" accept=".docx" class="hidden">
                    
                    <!-- Default View -->
                    <div id="upload-content" class="text-center pointer-events-none">
                        <i class="fa-solid fa-cloud-arrow-up text-4xl text-slate-300 mb-3 group-hover:text-blue-500 transition-colors"></i>
                        <p class="text-sm font-bold text-slate-600">Click to upload .DOCX</p>
                        <p class="text-xs text-slate-400 mt-1">Microsoft Word documents</p>
                    </div>

                    <!-- File Loaded View -->
                    <div id="file-info" class="hidden flex flex-col items-center w-full px-8">
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200 flex items-center gap-4 w-full">
                            <i class="fa-solid fa-file-word text-blue-700 text-2xl"></i>
                            <div class="flex-1 min-w-0 text-left">
                                <p id="filename" class="text-sm font-bold text-slate-800 truncate">document.docx</p>
                                <p id="filesize" class="text-xs text-slate-500">0 KB</p>
                            </div>
                            <i class="fa-solid fa-check-circle text-green-500"></i>
                        </div>
                    </div>
                </div>

                <!-- Preview Area (Hidden initially) -->
                <div id="preview-container" class="hidden">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider">Document Preview</h3>
                    </div>
                    <!-- This div simulates an A4 paper for preview -->
                    <div class="w-full h-64 overflow-y-auto bg-slate-100 border border-slate-200 rounded-lg p-4">
                        <div id="doc-preview" class="bg-white shadow-sm p-8 min-h-full text-sm">
                            <!-- Converted HTML goes here -->
                        </div>
                    </div>
                </div>

                <!-- Convert Button -->
                <button id="convert-btn" onclick="convertToPDF()" disabled class="w-full bg-slate-200 text-slate-400 font-bold py-3.5 rounded-lg transition-all flex items-center justify-center gap-2 cursor-not-allowed">
                    <span id="btn-text">Download PDF</span>
                    <i class="fa-solid fa-download"></i>
                </button>

                <!-- Warning Box -->
                <div class="bg-yellow-50 border border-yellow-100 rounded-lg p-4 flex gap-3 items-start">
                    <i class="fa-solid fa-triangle-exclamation text-yellow-500 mt-0.5"></i>
                    <div class="text-xs text-slate-600">
                        <strong class="block text-slate-700 mb-1">Formatting Note:</strong>
                        This tool reconstructs your document. Complex layouts (floating images, exact pagination) may shift slightly compared to the original Word file.
                    </div>
                </div>

            </div>
        </div>
    </main>

    <footer class="py-6 text-center text-slate-400 text-xs">
        &copy; 2023 Word2PDF Pro. Secure Processing.
    </footer>

    <script>
        const fileInput = document.getElementById('file-input');
        const dropZone = document.getElementById('drop-zone');
        const uploadContent = document.getElementById('upload-content');
        const fileInfo = document.getElementById('file-info');
        const filenameDisplay = document.getElementById('filename');
        const filesizeDisplay = document.getElementById('filesize');
        const convertBtn = document.getElementById('convert-btn');
        const previewContainer = document.getElementById('preview-container');
        const docPreview = document.getElementById('doc-preview');
        const btnText = document.getElementById('btn-text');

        let selectedFile = null;

        // --- Drag & Drop ---
        dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('border-blue-500', 'bg-blue-50'); });
        dropZone.addEventListener('dragleave', () => { dropZone.classList.remove('border-blue-500', 'bg-blue-50'); });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-blue-500', 'bg-blue-50');
            if(e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
        });

        // --- File Input ---
        fileInput.addEventListener('change', (e) => {
            if(e.target.files.length) handleFile(e.target.files[0]);
        });

        function handleFile(file) {
            // Validation
            if (!file.name.endsWith('.docx')) {
                alert("Please upload a .docx file (Microsoft Word).");
                return;
            }

            selectedFile = file;
            
            // UI Update
            filenameDisplay.textContent = file.name;
            filesizeDisplay.textContent = (file.size / 1024).toFixed(1) + " KB";
            uploadContent.classList.add('hidden');
            fileInfo.classList.remove('hidden');

            // Read and Preview
            readFileAndPreview(file);
        }

        function readFileAndPreview(file) {
            const reader = new FileReader();
            
            // Show loading state in preview
            previewContainer.classList.remove('hidden');
            docPreview.innerHTML = '<div class="text-center text-slate-400 py-10"><i class="fa-solid fa-circle-notch fa-spin text-2xl mb-2"></i><p>Generating Preview...</p></div>';

            reader.onload = function(event) {
                const arrayBuffer = event.target.result;

                mammoth.convertToHtml({arrayBuffer: arrayBuffer})
                    .then(displayResult)
                    .catch(handleError);
            };

            reader.readAsArrayBuffer(file);
        }

        function displayResult(result) {
            // Inject the HTML into the preview div
            docPreview.innerHTML = result.value;
            
            // Enable Download Button
            convertBtn.disabled = false;
            convertBtn.classList.remove('bg-slate-200', 'text-slate-400', 'cursor-not-allowed');
            convertBtn.classList.add('bg-blue-600', 'hover:bg-blue-700', 'text-white', 'shadow-lg');
            
            // Log messages from mammoth (optional warnings)
            // console.log(result.messages);
        }

        function handleError(err) {
            console.error(err);
            docPreview.innerHTML = '<p class="text-red-500 text-center">Error reading document. Please ensure it is a valid .docx file.</p>';
        }

        function convertToPDF() {
            if(!selectedFile) return;

            // UI Loading State
            convertBtn.disabled = true;
            const originalText = btnText.textContent;
            btnText.textContent = "Generating PDF...";
            convertBtn.classList.add('opacity-75', 'cursor-wait');

            // Options for html2pdf
            // We select the 'doc-preview' element which contains the converted HTML
            const element = document.getElementById('doc-preview');
            
            const opt = {
                margin:       [10, 10, 10, 10], // mm (top, left, bottom, right)
                filename:     selectedFile.name.replace('.docx', '.pdf'),
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true }, // scale: 2 improves text sharpness
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            // Run conversion
            html2pdf().set(opt).from(element).save().then(() => {
                // Reset UI after save
                setTimeout(() => {
                    btnText.textContent = "Download PDF";
                    convertBtn.disabled = false;
                    convertBtn.classList.remove('opacity-75', 'cursor-wait');
                }, 1000);
            });
        }
    </script>
</body>
                      </html>
